
THE ROOTKIT HUNTER PROJECT
==========================

Copyright (c) 2003-2006, Michael Boelen
See the LICENSE file for conditions of use and distribution.

It is recommended that all users of RootKit Hunter (RKH) join the
rkhunter-users mailing list. Subscribing to the list can be done via
the RKH website at http://rkhunter.sourceforge.net

A copy of the RKH FAQ is also available from the web site.


ROOTKIT HUNTER REQUIREMENTS
===========================

Please note RKH has some requirements:

1) Before RKH starts it will check that certain required commands
   are present on the system. These are typical commands such as
   'cat', 'sed', 'head', 'tail', etc. If a command is missing then
   RKH will not run.

2) Some tests require commands such as stat, md5/md5sum or
   sha1/sha1sum. If these are not present, then RKH has perl
   scripts which will automatically be used instead. However, this
   requires perl being present. If it is not, then the tests will
   be skipped.

3) A tool should be present with which to download file updates. 
   Currently wget, curl, (e)links, lynx and GET are supported. If your
   system does not allow the possibility to install one of these 
   applications, but does run perl, you can use "bget" available from 
   http://www.cpan.org/authors/id/E/EL/ELIJAH/. If you use another 
   generic method of updating RKH then please let us know.

4) Some tests require single-purpose tools. RKH does not depend on
   these, but it will use them if it finds them - they can enhance
   RKH's detection capabilities. The tools are:
   - Skdet
       Tests for SucKIT, Adore, Adore-NG, UNFshit, UNFkmem and
       frontkey.
       http://slider.decebal.org/code/skdet/
   - Unhide
       Finds hidden processes.
       http://www.security-projects.com/?Unhide


ROOTKIT HUNTER INSTALLATION
===========================

Unpacking the tar file should produce a single directory called
'rkhunter'. Within this directory is the installation script called
'installer.sh'.

To perform a default installation of RKH simply unpack the tarball and,
as root, run the installation script:

    tar zxf rkhunter-<version>.tar.gz
    cd rkhunter
    ./installer.sh --layout default --install

RKH installation supports custom layouts. To show some examples
run:

    ./installer.sh --examples

As an another example, to install all files beneath /opt, run:

    ./installer.sh --layout custom /opt --install

To show where files are installed using the "oldschool" layout
run:

    ./installer.sh --layout oldschool --show

The layout named "RPM" may not be chosen since it is used solely
for installing RKH using RPM.


The default installation process will install a configuration file,
called 'rkhunter.conf', into the '/etc' directory or where
you chose using the --layout switch. Please edit the configuration 
file according to your own system requirements. If the installer 
encounters an existing rkhunter.conf, it will not be overwritten.
Please inspect the new configuration file and copy over any changes
to the existing configuration file.

The main RKH script will be installed into the '/usr/local/bin'
directory or where you chose using the --layout switch. Man pages will 
be installed into '/usr/local/share/man', and other documentation will 
be installed into the '/usr/local/share/doc' directory. RKH data files,
language support, and a directory for temporary files will be
installed into '/var/rkhunter'. All directories will be created 
where necessary.

To run RKH, as root simply enter the following command:

    rkhunter --check

By default, the log file '/var/log/rkhunter.log' will be created. It
will contain the results of the checks made by RKH.

To see what other options can be used with rkhunter, enter:

    rkhunter --help


NOTE: The first run of 'rkhunter' after installation is likely to
      give some warning messages. Please see the FAQ file for more
      details about this.


STANDALONE INSTALLATION
=======================

It is possible to run RKH standalone, that is, with it all being
installed into one directory.

To do this unpack RKH as described above, and then install it using
the following command:

    ./installer.sh --layout custom . --install

It is then necessary to change to the 'files' directory:

    cd files

Within the directory will be a copy of the 'rkhunter.conf' configuration
file. You can modify this file according to your requirements if you
wish, but note the installer has already set the necessary variables.

To run RKH, as root simply enter the following command:

    ./rkhunter --check


REMOVING AN INSTALLATION
========================

RKH supports uninstallation. To do this unpack the installation
tarball, and then run the installer with the --remove option. If RKH
was installed using a default installation, then run:

    tar zxf rkhunter-<version>.tar.gz
    cd rkhunter
    ./installer.sh --layout default --remove

If you chose a different layout, for example '/usr', then run the
installer using:

    ./installer.sh --layout /usr --remove

Note: the installer will not remove files that were installed using RPM
(use the "rpm" command to remove the package), or when a custom layout
was chosen. However, a standalone uninstallation, specified by using
'--layout custom .', will remove the whole installation directory (the
'files' sub-directory).

If you chose a custom layout, for example '/opt', then you can run the
installer to show where the files were installed:

    ./installer.sh --layout custom /opt --show

You can then manually remove the files.


TEST NAMES
==========
jh - fill this bit in!


ROOTKIT HUNTER SUPPORT
======================

If a problem is found with RKH, it is recommended that users initially
try and resolve the problem themselves. This can be done by first
checking the FAQ file, which is present in your installation if the
distributed tarball is used as source. The FAQ will contain answers 
to many common problems. The latest version of the FAQ can always be 
found at RKH's project pages on SourceForge, in the "Documentation" 
section.

If the problem has occurred directly after upgrading RKH, then please
check the CHANGELOG file. It will contain information about changes
made since the previous version of RKH, and may indicate why you are
now experiencing a problem.

Users should also check the rkhunter-users mailing list archives
(available on the web site). The problem will be investigated by the
RKH development team, and, where appropriate, a solution posted on the
mailing list. Hence the mailing list archives may well contain a
solution to the problem.

Additionally, users should check the RKH tracker system (available at
http://sourceforge.net/tracker/?group_id=155034). It is quite
possible that the problem has already been reported to us as a bug or
support request. It is also possible that a fix for the problem has
been provided in the tracker log.

Depending upon the nature of the problem it may be worthwhile trying
an Internet search (for example using google), to see if anyone else
has experienced a similar problem.

Finally, if you have still not found an answer to the problem, then
mail it to the rkhunter-users mailing list. Please provide as much
information as possible about the problem, but do not make the
message excessively long! Information such as your operating system
and version of RKH should always be included.

If you are sure the problem is a bug, or want it considered as a
support request, then please submit it directly into the tracker
system.

